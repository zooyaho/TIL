# Hydration Mismatch

> Hydration Mismatch는 Next.js와 같은 React 기반 프레임워크에서 발생하는 문제로, 클라이언트 측에서 서버에서 생성한 HTML과 클라이언트에서 렌더링한 HTML이 일치하지 않을 때 발생합니다. 이 문제를 이해하기 위해서는 서버에서 DOM을 그리는 과정과 정적 HTML 파일을 생성하는 과정의 차이를 이해하는 것이 중요합니다.

## 1. 서버에서 DOM을 그리는 과정

서버 사이드 렌더링(SSR)에서는 사용자가 요청한 페이지에 대해 서버에서 HTML을 생성합니다. 이 과정은 다음과 같습니다:

- 서버 요청: 클라이언트가 특정 페이지를 요청하면, 서버는 해당 페이지의 React 컴포넌트를 실행합니다.
- HTML 생성: React가 서버에서 DOM을 생성하고, 그 결과를 HTML 문자열로 변환합니다.
- 클라이언트 전송: 생성된 HTML이 클라이언트로 전송됩니다. 이때, React가 클라이언트에서 동일한 DOM을 렌더링하도록 준비합니다.

이 과정에서 HTML은 서버에서 미리 생성되므로, 클라이언트는 HTML을 즉시 표시할 수 있습니다.

## 2. 정적 HTML 파일 생성 (SSG)

정적 사이트 생성(SSG)은 빌드 시 미리 HTML 파일을 생성하여 제공하는 방식입니다. 이 과정은 다음과 같습니다:

- 빌드 시 데이터 패칭: 빌드 과정에서 getStaticProps()와 같은 메서드를 사용하여 필요한 데이터를 가져옵니다.
- HTML 파일 생성: React가 데이터를 기반으로 DOM을 생성하고, 이 결과를 정적 HTML 파일로 저장합니다.
- 서버 또는 CDN에 배포: 생성된 HTML 파일은 서버나 CDN에 배포되어, 사용자가 요청할 때 바로 제공됩니다.

이 방식에서도 클라이언트는 HTML을 즉시 표시할 수 있으며, 페이지가 요청될 때 서버에서 새로운 렌더링이 필요하지 않습니다.

## Hydration Mismatch 문제

Hydration Mismatch는 다음과 같은 상황에서 발생할 수 있습니다:

- 서버에서 렌더링한 HTML과 클라이언트에서 렌더링한 HTML이 다를 경우: 예를 들어, 클라이언트에서 상태나 props가 변경되었을 때, 서버에서 생성된 HTML과 클라이언트에서 React가 다시 렌더링한 HTML이 일치하지 않는 경우입니다. 이 경우, React는 클라이언트에서 서버가 보낸 HTML을 "hydration"하려고 시도하지만, 두 DOM 트리가 일치하지 않아 경고가 발생할 수 있습니다.

## 요약

- 서버에서 DOM을 그리는 과정: 요청 시 서버에서 React 컴포넌트를 실행하여 HTML을 생성하고 클라이언트에 전달합니다.
- 정적 HTML 파일 생성 (SSG): 빌드 시 미리 HTML을 생성하여 정적 파일로 저장하고, 요청 시 클라이언트에 제공됩니다.
- Hydration Mismatch: 서버에서 생성한 HTML과 클라이언트에서 다시 렌더링한 HTML이 일치하지 않을 때 발생하는 문제입니다.
